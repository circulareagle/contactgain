<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NaijaPro Contact Gain - Premium VCF Infrastructure</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        
        :root {
            --primary: #059669;
            --primary-dark: #064e3b;
            --vcf-red: #ef4444;
            --vcf-grey: #94a3b8;
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8fafc;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        
        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .nav-item.active { color: var(--primary); }
        
        /* Scanning Animation */
        .scan-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: rgba(5, 150, 105, 0.5);
            box-shadow: 0 0 15px 2px #10b981;
            top: 0;
            left: 0;
            animation: scanning 2s linear infinite;
        }

        @keyframes scanning {
            0% { top: 0%; }
            50% { top: 100%; }
            100% { top: 0%; }
        }

        /* Pipeline Styles */
        .pipeline-container {
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid #cbd5e1;
        }
        .pipeline-fill {
            height: 100%;
            transition: width 1s ease-in-out;
            background: repeating-linear-gradient(45deg, #ef4444, #ef4444 10px, #dc2626 10px, #dc2626 20px);
        }
        .pipeline-empty { background: #cbd5e1 !important; }
    </style>
</head>
<body class="text-slate-900 pb-28">

    <!-- MODALS -->
    <!-- 1. Custom Alert -->
    <div id="custom-alert" class="fixed inset-0 z-[100] hidden items-center justify-center p-6 bg-slate-900/60 backdrop-blur-md">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl">
            <div id="alert-icon" class="mb-4 text-center"></div>
            <h3 id="alert-title" class="text-xl font-bold text-slate-900 mb-2 text-center"></h3>
            <p id="alert-message" class="text-sm text-slate-600 mb-8 leading-relaxed text-center"></p>
            <button onclick="closeAlert()" class="w-full bg-emerald-600 text-white font-bold py-4 rounded-2xl shadow-lg">Got it!</button>
        </div>
    </div>

    <!-- 2. WhatsApp Channel Pop (Interstitial) -->
    <div id="welcome-promo" class="fixed inset-0 z-[90] hidden items-center justify-center p-6 bg-slate-900/60 backdrop-blur-md">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl text-center">
            <div class="bg-emerald-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="bell" class="text-emerald-600 w-8 h-8"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-900 mb-2">Join Our Channel</h3>
            <p class="text-sm text-slate-600 mb-8">Join the WhatsApp Channel for instant upload alerts before continuing to files.</p>
            <div class="space-y-3">
                <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="block w-full bg-emerald-600 text-white font-bold py-4 rounded-2xl">Join Channel</a>
                <button onclick="proceedToFiles()" class="w-full text-slate-400 font-bold py-2 text-sm">Close and Continue</button>
            </div>
        </div>
    </div>

    <!-- 3. Verification Sincerity Bot Modal -->
    <div id="verify-modal" class="fixed inset-0 z-[110] hidden items-center justify-center p-6 bg-slate-900/90 backdrop-blur-xl">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl relative overflow-hidden">
            <div class="scan-line"></div>
            <h3 class="text-lg font-bold text-slate-900 mb-6 flex items-center gap-2">
                <i data-lucide="shield-check" class="text-emerald-600"></i>
                Cross-Platform Verification
            </h3>
            
            <div class="space-y-6" id="check-list">
                <div class="flex items-center gap-4 text-slate-400 transition-colors" id="step-1">
                    <div class="loader-circle w-5 h-5 border-2 border-slate-200 border-t-emerald-600 rounded-full animate-spin"></div>
                    <span class="text-xs font-bold uppercase tracking-wider">Link Origin Check</span>
                </div>
                <div class="flex items-center gap-4 text-slate-400" id="step-2">
                    <div class="w-5 h-5 border-2 border-slate-200 rounded-full"></div>
                    <span class="text-xs font-bold uppercase tracking-wider">WhatsApp Handshake</span>
                </div>
                <div class="flex items-center gap-4 text-slate-400" id="step-3">
                    <div class="w-5 h-5 border-2 border-slate-200 rounded-full"></div>
                    <span class="text-xs font-bold uppercase tracking-wider">Metadata Verification</span>
                </div>
            </div>

            <p class="mt-8 text-[10px] text-slate-400 text-center uppercase tracking-widest font-bold">Checking WhatsApp Status Session...</p>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white border-b border-slate-100 p-5 sticky top-0 z-40">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-xl font-800 tracking-tight text-emerald-900 flex items-center gap-2">
                    <span class="bg-emerald-600 text-white p-1 rounded-lg"><i data-lucide="briefcase" class="w-5 h-5"></i></span>
                    NaijaPro Contact Gain
                </h1>
                <p class="text-[9px] font-bold text-emerald-600/60 uppercase tracking-widest mt-1">Networking Batch Infrastructure</p>
            </div>
            <div id="user-status-indicator"></div>
        </div>
    </header>

    <main class="max-w-md mx-auto p-5">
        
        <!-- SECTION: HOME / REGISTRATION -->
        <section id="tab-home" class="tab-content active space-y-6">
            <div id="guest-view" class="space-y-6">
                <div class="bg-white rounded-3xl shadow-sm p-6 border border-slate-100">
                    <h2 class="text-xl font-bold text-slate-800">Register Your Business</h2>
                    <p class="text-xs text-slate-400 mb-6">Gain access to 10 batches of VCF contacts.</p>
                    
                    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted){onRegistrationComplete();}"></iframe>
                    <form id="reg-form" action="https://docs.google.com/forms/d/e/1FAIpQLSc1Yz0jF5wANDrrZe_DgU5yMx6cWX_2BgzI8gNUHQUTe4XQCQ/formResponse" method="POST" target="hidden_iframe" onsubmit="submitted=true;" class="space-y-5">
                        <input required type="text" name="entry.403300635" placeholder="Business Name" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none text-sm focus:border-emerald-500">
                        <input required type="tel" name="entry.1493637334" placeholder="WhatsApp Number (080...)" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none text-sm focus:border-emerald-500">
                        <div class="grid grid-cols-2 gap-4">
                            <select required name="entry.50410248" id="cat-select" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl text-sm outline-none">
                                <option value="" disabled selected>Category</option>
                            </select>
                            <select required name="entry.1635387367" id="state-select" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl text-sm outline-none">
                                <option value="" disabled selected>Location (State)</option>
                            </select>
                        </div>
                        <button type="submit" class="w-full bg-emerald-600 text-white font-bold py-5 rounded-2xl shadow-xl shadow-emerald-100 uppercase text-xs tracking-widest active:scale-95 transition-all">Join & Unlock Batches</button>
                    </form>
                </div>
            </div>

            <div id="member-view" class="hidden space-y-6">
                <div class="bg-emerald-600 rounded-3xl p-8 text-white shadow-xl">
                    <h2 class="text-2xl font-bold">Welcome Back!</h2>
                    <p class="text-sm opacity-90 mt-2 italic">Your business profile is verified.</p>
                    <div class="mt-8">
                        <button onclick="triggerWelcomePromo()" class="w-full bg-white text-emerald-700 font-bold py-4 rounded-2xl flex items-center justify-center gap-2 shadow-lg">
                            <i data-lucide="arrow-right-circle" class="w-5 h-5"></i> Go to VCF Files
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION: VCF FILES -->
        <section id="tab-files" class="tab-content space-y-6">
            <div id="files-locked-msg" class="py-20 text-center space-y-4">
                <i data-lucide="lock" class="mx-auto w-12 h-12 text-slate-300"></i>
                <p class="text-slate-400 text-sm px-10">You must register on the Home page to unlock the VCF directory.</p>
                <button onclick="switchTab('home')" class="text-emerald-600 font-bold text-xs uppercase underline">Go to Registration</button>
            </div>

            <div id="files-unlocked-container" class="hidden space-y-5">
                <div class="flex justify-between items-end px-2">
                    <div>
                        <span class="text-[10px] font-bold text-emerald-600 uppercase tracking-widest">VCF Directory</span>
                        <h2 class="text-2xl font-800 text-slate-900 tracking-tight">Active Batches</h2>
                    </div>
                    <div class="text-right">
                        <p id="config-update-date" class="text-[10px] font-bold text-slate-400"></p>
                    </div>
                </div>

                <div id="vcf-render-list" class="space-y-4">
                    <!-- JS Generated Cards -->
                </div>

                <div class="bg-white border border-slate-100 p-5 rounded-3xl shadow-sm text-center">
                   <p class="text-xs text-slate-500 italic">"A new batch of vendors is added every 24-48 hours. Check back here to get the latest version without re-registering."</p>
                   <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="block mt-3 text-emerald-600 font-bold text-xs uppercase underline tracking-tighter">Official WhatsApp Channel</a>
                </div>
            </div>
        </section>

        <!-- SECTION: SAFETY -->
        <section id="tab-safety" class="tab-content space-y-6">
            <div class="bg-slate-900 p-8 rounded-3xl text-white">
                <h2 class="text-xl font-bold flex items-center gap-2"><i data-lucide="shield-check"></i> Security Protocol</h2>
                <p class="text-xs text-slate-400 mt-2 leading-relaxed">Ensure you have 2-Step Verification enabled on WhatsApp before importing large VCF files to protect your account.</p>
            </div>
            <div class="bg-white p-6 rounded-3xl border border-slate-100 flex gap-4">
                <i data-lucide="info" class="text-emerald-600"></i>
                <p class="text-[11px] text-slate-500 font-medium">Downloading files from unknown sources is risky. Our VCF files are scanned and verified for business networking only.</p>
            </div>
        </section>
    </main>

    <!-- Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-xl border-t border-slate-100 flex justify-around items-center h-20 z-50">
        <button onclick="switchTab('home')" class="nav-item active flex flex-col items-center gap-1" data-tab="home">
            <i data-lucide="home" class="w-5 h-5"></i>
            <span class="text-[10px] font-bold uppercase">Home</span>
        </button>
        <button onclick="switchTab('files')" class="nav-item flex flex-col items-center gap-1" data-tab="files">
            <i data-lucide="layers" class="w-5 h-5"></i>
            <span class="text-[10px] font-bold uppercase">Files</span>
        </button>
        <button onclick="switchTab('safety')" class="nav-item flex flex-col items-center gap-1" data-tab="safety">
            <i data-lucide="shield" class="w-5 h-5"></i>
            <span class="text-[10px] font-bold uppercase">Safety</span>
        </button>
    </nav>

    <script>
        const CONFIG = {
            updateDate: "Updated Today, 11:45 PM",
            shareTarget: 4, // Requirement per VCF
            shareText: "Grow your business contacts for free on NaijaPro! Register and get the latest VCF batches here: " + window.location.href,
            minShareSeconds: 10, // Sincerity Bot: must spend 10s on WhatsApp
            vcfData: [
                { id: 1, count: 850, status: "Ongoing", file: "Batch1_Contacts.vcf" },
                { id: 2, count: 0, status: "Not yet activated", file: "Batch2_Contacts.vcf" },
                { id: 3, count: 0, status: "Not yet activated", file: "Batch3_Contacts.vcf" },
                { id: 4, count: 0, status: "Not yet activated", file: "Batch4_Contacts.vcf" },
                { id: 5, count: 0, status: "Not yet activated", file: "Batch5_Contacts.vcf" },
                { id: 6, count: 0, status: "Not yet activated", file: "Batch6_Contacts.vcf" },
                { id: 7, count: 0, status: "Not yet activated", file: "Batch7_Contacts.vcf" },
                { id: 8, count: 0, status: "Not yet activated", file: "Batch8_Contacts.vcf" },
                { id: 9, count: 0, status: "Not yet activated", file: "Batch9_Contacts.vcf" },
                { id: 10, count: 0, status: "Not yet activated", file: "Batch10_Contacts.vcf" }
            ]
        };

        const IS_REGISTERED_KEY = 'naijapro_user_registered_v3';
        const TASK_PROGRESS_KEY = 'naijapro_vcf_tasks_v3';
        const DOWNLOADED_HISTORY_KEY = 'naijapro_downloaded_history_v3';

        const ALL_NIGERIAN_STATES = [
            "Abia", "Adamawa", "Akwa Ibom", "Anambra", "Bauchi", "Bayelsa", "Benue", "Borno", 
            "Cross River", "Delta", "Ebonyi", "Edo", "Ekiti", "Enugu", "FCT - Abuja", "Gombe", 
            "Imo", "Jigawa", "Kaduna", "Kano", "Katsina", "Kebbi", "Kogi", "Kwara", "Lagos", 
            "Nasarawa", "Niger", "Ogun", "Ondo", "Osun", "Oyo", "Plateau", "Rivers", "Sokoto", 
            "Taraba", "Yobe", "Zamfara"
        ];

        let submitted = false;
        let lastShareStart = 0;
        let currentActiveVcfId = null;

        function init() {
            populateSelects();
            checkAuth();
            renderFiles();
            lucide.createIcons();
            document.getElementById('config-update-date').innerText = CONFIG.updateDate;
        }

        function populateSelects() {
            const categories = ["Fashion & Lifestyle", "Gadgets & Electronics", "Real Estate", "Beauty & Skincare", "Logistics & Delivery", "Digital Assets/Crypto", "Automobiles", "Food & Groceries", "Interior Decor", "Education", "Consultancy", "Others"];
            const cSel = document.getElementById('cat-select');
            const sSel = document.getElementById('state-select');
            
            categories.forEach(c => cSel.add(new Option(c, c)));
            ALL_NIGERIAN_STATES.forEach(s => sSel.add(new Option(s, s)));
        }

        function checkAuth() {
            const isReg = localStorage.getItem(IS_REGISTERED_KEY);
            const guestView = document.getElementById('guest-view');
            const memberView = document.getElementById('member-view');
            const lockedMsg = document.getElementById('files-locked-msg');
            const unlockedCont = document.getElementById('files-unlocked-container');
            const indicator = document.getElementById('user-status-indicator');

            if (isReg) {
                guestView.classList.add('hidden');
                memberView.classList.remove('hidden');
                lockedMsg.classList.add('hidden');
                unlockedCont.classList.remove('hidden');
                indicator.innerHTML = `<span class="px-2 py-1 bg-emerald-100 text-emerald-700 text-[10px] font-bold rounded-lg border border-emerald-200">VERIFIED</span>`;
            } else {
                guestView.classList.remove('hidden');
                memberView.classList.add('hidden');
                lockedMsg.classList.remove('hidden');
                unlockedCont.classList.add('hidden');
                indicator.innerHTML = `<span class="px-2 py-1 bg-slate-100 text-slate-500 text-[10px] font-bold rounded-lg border border-slate-200">GUEST</span>`;
            }
        }

        function renderFiles() {
            const container = document.getElementById('vcf-render-list');
            const tasks = JSON.parse(localStorage.getItem(TASK_PROGRESS_KEY) || '{}');
            const history = JSON.parse(localStorage.getItem(DOWNLOADED_HISTORY_KEY) || '[]');

            container.innerHTML = CONFIG.vcfData.map(vcf => {
                const currentProgress = tasks[vcf.id] || 0;
                const isDownloaded = history.includes(vcf.id);
                const isOngoing = vcf.id === 1;
                const percentage = (vcf.count / 1000) * 100;

                let pipeLabel = vcf.count >= 1000 ? "Full" : (vcf.count > 0 ? "Filing..." : "Empty");
                let statusStyle = isOngoing ? 'text-red-600 font-extrabold' : 'text-slate-400 font-bold';
                
                let buttonContent = '';
                
                if (isDownloaded) {
                    buttonContent = `
                        <div class="space-y-3">
                             <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="w-full bg-emerald-600 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-2 text-sm shadow-md">
                                <i data-lucide="message-circle" class="w-4 h-4 text-white"></i> Join WhatsApp Channel
                             </a>
                             <p class="text-[10px] text-slate-400 font-bold text-center leading-tight">This file has been locked again for tomorrow's next VCF. Share to your status + 4 Groups/People to prepare.</p>
                             <button onclick="initiateShare(${vcf.id})" class="w-full py-2 text-[10px] font-bold text-emerald-600 uppercase border border-dashed border-emerald-200 rounded-xl">Pre-share Now (+1)</button>
                        </div>
                    `;
                } else if (currentProgress >= CONFIG.shareTarget) {
                    buttonContent = `
                        <div class="space-y-3">
                            <button onclick="performDownload(${vcf.id})" class="w-full bg-slate-900 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-2 text-sm active:scale-95 transition-all shadow-lg">
                                <i data-lucide="download" class="w-4 h-4 text-emerald-400"></i> Download Batch ${vcf.id}
                            </button>
                            <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="w-full bg-emerald-500 text-white font-bold py-3 rounded-2xl flex items-center justify-center gap-2 text-[12px] shadow-sm">
                                <i data-lucide="message-circle" class="w-4 h-4"></i> Join WhatsApp Channel
                            </a>
                        </div>
                    `;
                } else {
                    buttonContent = `
                        <div class="space-y-3">
                            <button onclick="initiateShare(${vcf.id})" class="w-full bg-slate-100 text-slate-600 font-bold py-4 rounded-2xl flex items-center justify-center gap-2 text-sm active:bg-slate-200 transition-all">
                                <i data-lucide="share-2" class="w-4 h-4 text-emerald-500"></i> Share to Unlock (${currentProgress}/${CONFIG.shareTarget})
                            </button>
                            <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="w-full bg-emerald-600 text-white font-bold py-3 rounded-2xl flex items-center justify-center gap-2 text-[12px] shadow-sm">
                                <i data-lucide="message-circle" class="w-4 h-4"></i> Join WhatsApp Channel
                            </a>
                        </div>
                    `;
                }

                return `
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 space-y-4">
                        <div class="flex justify-between items-start">
                            <div class="flex gap-4">
                                <div class="w-12 h-12 rounded-2xl bg-slate-50 flex items-center justify-center ${isOngoing ? 'text-red-500' : 'text-slate-400'}">
                                    <i data-lucide="file-spreadsheet"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-slate-800">Batch ${vcf.id} VCF</h4>
                                    <span class="text-[10px] uppercase ${statusStyle}">${vcf.status}</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-xs font-bold text-slate-800">${vcf.count}/1000</p>
                                <p class="text-[9px] text-slate-400 uppercase font-bold">Limit</p>
                            </div>
                        </div>

                        <div class="space-y-1">
                            <div class="pipeline-container">
                                <div class="pipeline-fill ${vcf.count === 0 ? 'pipeline-empty' : ''}" style="width: ${percentage}%"></div>
                            </div>
                            <div class="flex justify-between items-center">
                                <p class="text-[9px] font-bold text-slate-400 uppercase">${pipeLabel}</p>
                                ${vcf.count > 0 ? `<span class="text-[10px] font-bold text-red-500">${Math.round(percentage)}%</span>` : ''}
                            </div>
                        </div>

                        <div class="pt-2">
                            ${buttonContent}
                        </div>
                    </div>
                `;
            }).join('');
            lucide.createIcons();
        }

        function initiateShare(vcfId) {
            currentActiveVcfId = vcfId;
            lastShareStart = Date.now();
            const url = `https://api.whatsapp.com/send?text=${encodeURIComponent(CONFIG.shareText)}`;
            window.open(url, '_blank');

            // Delay showing the verification modal to ensure they "left" the app
            setTimeout(startVerificationFlow, 1000);
        }

        async function startVerificationFlow() {
            const modal = document.getElementById('verify-modal');
            modal.style.display = 'flex';

            const steps = [document.getElementById('step-1'), document.getElementById('step-2'), document.getElementById('step-3')];
            steps.forEach(s => {
                s.className = "flex items-center gap-4 text-slate-400 transition-all";
                s.querySelector('div').className = "w-5 h-5 border-2 border-slate-200 rounded-full";
                s.querySelector('div').innerHTML = '';
            });

            // Sequence 
            await wait(1500); markStep(steps[0]);
            await wait(2500); markStep(steps[1]);
            await wait(2000); 

            const timeSpent = (Date.now() - lastShareStart) / 1000;

            if (timeSpent < CONFIG.minShareSeconds) {
                modal.style.display = 'none';
                showAlert('Security Alert', 'System detect no sharing was initiated. You returned to the app too quickly. Please stay on WhatsApp and complete the share to status.', 'alert-triangle');
            } else {
                markStep(steps[2]);
                await wait(800);
                modal.style.display = 'none';
                updateTask(currentActiveVcfId);
            }
        }

        function markStep(el) {
            el.className = "flex items-center gap-4 text-emerald-600 transition-all font-bold";
            el.querySelector('div').className = "w-5 h-5 bg-emerald-600 rounded-full flex items-center justify-center";
            el.querySelector('div').innerHTML = `<i data-lucide="check" class="w-3 h-3 text-white"></i>`;
            lucide.createIcons();
        }

        function updateTask(id) {
            let tasks = JSON.parse(localStorage.getItem(TASK_PROGRESS_KEY) || '{}');
            tasks[id] = (tasks[id] || 0) + 1;
            localStorage.setItem(TASK_PROGRESS_KEY, JSON.stringify(tasks));
            renderFiles();
            
            if(tasks[id] >= CONFIG.shareTarget) {
                showAlert('Task Completed!', `Batch ${id} has been fully unlocked. You can now download the file.`, 'unlock');
            } else {
                showAlert('Status Verified', `Share count updated (${tasks[id]}/${CONFIG.shareTarget}). Continue sharing to unlock completely.`, 'check');
            }
        }

        function performDownload(vcfId) {
            const vcf = CONFIG.vcfData.find(v => v.id === vcfId);
            
            // Log Download History
            let history = JSON.parse(localStorage.getItem(DOWNLOADED_HISTORY_KEY) || '[]');
            if(!history.includes(vcfId)) history.push(vcfId);
            localStorage.setItem(DOWNLOADED_HISTORY_KEY, JSON.stringify(history));

            // Trigger actual download (mockup)
            const link = document.createElement('a');
            link.href = 'data:text/vcard;charset=utf-8,' + encodeURIComponent('BEGIN:VCARD\nFN:NaijaPro Batch ' + vcfId + '\nEND:VCARD');
            link.download = vcf.file;
            link.click();

            renderFiles();
        }

        function onRegistrationComplete() {
            localStorage.setItem(IS_REGISTERED_KEY, 'true');
            checkAuth();
            switchTab('home'); 
            showAlert('Success!', 'Registration complete. Welcome to the elite networking hub.', 'party-popper');
        }

        function triggerWelcomePromo() {
            document.getElementById('welcome-promo').style.display = 'flex';
        }

        function proceedToFiles() {
            document.getElementById('welcome-promo').style.display = 'none';
            switchTab('files');
        }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(`tab-${id}`).classList.add('active');
            document.querySelector(`[data-tab="${id}"]`).classList.add('active');
            window.scrollTo(0,0);
        }

        function showAlert(title, msg, icon) {
            document.getElementById('alert-title').innerText = title;
            document.getElementById('alert-message').innerText = msg;
            document.getElementById('alert-icon').innerHTML = `<i data-lucide="${icon}" class="w-12 h-12 text-emerald-600 mx-auto"></i>`;
            document.getElementById('custom-alert').style.display = 'flex';
            lucide.createIcons();
        }

        function closeAlert() { document.getElementById('custom-alert').style.display = 'none'; }
        function wait(ms) { return new Promise(res => setTimeout(res, ms)); }

        window.onload = init;
    </script>
</body>
</html>

