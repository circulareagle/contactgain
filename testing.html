<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NaijaPro Contact Gain</title>
    <meta property="og:image" content="https://vcf.circulareagle.com/social-share-image.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        
        :root {
            --primary: #059669;
            --primary-dark: #064e3b;
            --vcf-red: #ef4444;
            --vcf-grey: #94a3b8;
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            background-color: #f8fafc;
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        
        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .nav-item.active { color: var(--primary); }
        .nav-item.active i { transform: translateY(-4px); transition: transform 0.3s ease; }
        
        #custom-alert, #whatsapp-promo, #verification-modal { display: none; }

        /* Pipeline Styles */
        .pipeline-container {
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 999px;
            position: relative;
            overflow: hidden;
            border: 1px solid #cbd5e1;
        }
        .pipeline-fill {
            height: 100%;
            transition: width 0.8s ease-in-out;
            background: repeating-linear-gradient(
                45deg,
                var(--vcf-red),
                var(--vcf-red) 10px,
                #dc2626 10px,
                #dc2626 20px
            );
        }
        .pipeline-empty {
            background: #cbd5e1 !important;
        }

        /* Scan Line Animation */
        .scan-line {
            position: absolute;
            left: 0;
            width: 100%;
            height: 2px;
            background: rgba(16, 185, 129, 0.5);
            box-shadow: 0 0 15px 2px rgba(16, 185, 129, 0.8);
            animation: scan 2s linear infinite;
        }
        @keyframes scan {
            0% { top: 0%; }
            100% { top: 100%; }
        }
    </style>
</head>
<body class="text-slate-900 pb-28">

    <!-- Premium Header -->
    <header class="bg-white border-b border-slate-100 p-5 sticky top-0 z-40">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-xl font-800 tracking-tight text-emerald-900 flex items-center gap-2">
                    <span class="bg-emerald-600 text-white p-1 rounded-lg"><i data-lucide="briefcase" class="w-5 h-5"></i></span>
                    NaijaPro Contact Gain
                </h1>
                <p class="text-[10px] font-bold text-emerald-600/60 uppercase tracking-widest mt-1">Commercial Networking Only</p>
            </div>
            <div id="user-status" class="flex gap-2 items-center"></div>
        </div>
    </header>

    <!-- Alert Modal -->
    <div id="custom-alert" class="fixed inset-0 z-[60] flex items-center justify-center p-6 bg-slate-900/40 backdrop-blur-md">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl">
            <div id="alert-icon" class="mb-4 text-center"></div>
            <h3 id="alert-title" class="text-xl font-bold text-slate-900 mb-2 text-center">Notice</h3>
            <p id="alert-message" class="text-sm text-slate-600 mb-8 leading-relaxed text-center"></p>
            <button onclick="closeAlert()" class="w-full bg-emerald-600 text-white font-bold py-4 rounded-2xl transition-all active:scale-95 shadow-lg shadow-emerald-200">Got it!</button>
        </div>
    </div>

    <!-- Verification Modal (Sincerity Bot) -->
    <div id="verification-modal" class="fixed inset-0 z-[70] flex items-center justify-center p-6 bg-slate-900/80 backdrop-blur-xl">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl relative overflow-hidden">
            <div class="scan-line"></div>
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-emerald-50 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i data-lucide="shield-check" class="text-emerald-600 w-8 h-8 animate-pulse"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-900">Verification in Progress</h3>
                <p class="text-[10px] text-slate-400 uppercase tracking-widest font-bold">Cross-Platform Syncing</p>
            </div>

            <div class="space-y-4" id="verification-checklist">
                <div class="flex items-center gap-3 opacity-25 transition-opacity duration-300" id="step-1">
                    <div class="check-icon w-5 h-5 rounded-full bg-emerald-100 flex items-center justify-center">
                        <i data-lucide="check" class="w-3 h-3 text-emerald-600 hidden"></i>
                    </div>
                    <span class="text-xs font-semibold text-slate-600">WhatsApp Handshake</span>
                </div>
                <div class="flex items-center gap-3 opacity-25 transition-opacity duration-300" id="step-2">
                    <div class="check-icon w-5 h-5 rounded-full bg-emerald-100 flex items-center justify-center">
                        <i data-lucide="check" class="w-3 h-3 text-emerald-600 hidden"></i>
                    </div>
                    <span class="text-xs font-semibold text-slate-600">Metadata Extraction</span>
                </div>
                <div class="flex items-center gap-3 opacity-25 transition-opacity duration-300" id="step-3">
                    <div class="check-icon w-5 h-5 rounded-full bg-emerald-100 flex items-center justify-center">
                        <i data-lucide="check" class="w-3 h-3 text-emerald-600 hidden"></i>
                    </div>
                    <span class="text-xs font-semibold text-slate-600">Status Post Entry Validation</span>
                </div>
            </div>

            <div class="mt-8">
                <div class="w-full bg-slate-100 h-1.5 rounded-full overflow-hidden">
                    <div id="verification-progress" class="bg-emerald-500 h-full w-0 transition-all duration-[6000ms] linear"></div>
                </div>
                <p class="text-[9px] text-center text-slate-400 mt-2 font-bold uppercase">System is performing a cross-platform check...</p>
            </div>
        </div>
    </div>

    <!-- WhatsApp Channel Promo Modal -->
    <div id="whatsapp-promo" class="fixed inset-0 z-50 flex items-center justify-center p-6 bg-slate-900/60 backdrop-blur-md">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl text-center">
            <div class="bg-emerald-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="bell" class="text-emerald-600 w-8 h-8"></i>
            </div>
            <h3 class="text-xl font-bold text-slate-900 mb-2">Join Official Channel!</h3>
            <p class="text-sm text-slate-600 mb-8 leading-relaxed">Before accessing the files, make sure to join our WhatsApp Channel for real-time updates on new VCF drops.</p>
            <div class="space-y-3">
                <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" onclick="finishPromo()" class="block w-full bg-emerald-600 text-white font-bold py-4 rounded-2xl shadow-lg shadow-emerald-200">Join Channel Now</a>
                <button onclick="finishPromo()" class="w-full text-slate-400 font-bold py-2 text-sm">Cancel / Done</button>
            </div>
        </div>
    </div>

    <main class="max-w-md mx-auto p-5">
        
        <!-- REGISTRATION SECTION -->
        <section id="tab-home" class="tab-content active space-y-6">
            <div id="member-view" class="hidden space-y-6">
                <div class="bg-emerald-600 rounded-3xl p-8 text-white shadow-xl">
                    <h2 class="text-2xl font-bold">Welcome Back!</h2>
                    <p class="text-sm opacity-90 mt-2">You are a verified member. Access your 10 VCF files below.</p>
                    <div class="mt-6">
                         <button onclick="handleGoToFiles()" class="w-full bg-white text-emerald-700 font-bold py-4 rounded-2xl flex items-center justify-center gap-2">
                            <i data-lucide="file-down" class="w-5 h-5"></i> Go to VCF Files
                        </button>
                    </div>
                </div>
            </div>

            <div id="guest-view" class="space-y-6">
                <div class="bg-emerald-50 border border-emerald-100 p-5 rounded-3xl">
                    <div class="flex gap-4">
                        <div class="bg-white p-2 h-fit rounded-xl shadow-sm">
                            <i data-lucide="lock" class="text-emerald-600 w-5 h-5"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-emerald-900 text-sm">Restricted Access</h3>
                            <p class="text-xs text-emerald-800/70 leading-relaxed mt-1">
                                Join the directory to unlock the 10-batch VCF networking files.
                            </p>
                        </div>
                    </div>
                </div>

                <div id="form-container" class="bg-white rounded-3xl shadow-sm p-6 border border-slate-100">
                    <div class="mb-6">
                        <h2 class="text-xl font-bold text-slate-800">Register Your Business</h2>
                        <p class="text-xs text-slate-400 mt-1">Join thousands of Nigerian professionals.</p>
                    </div>
                  
                    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted){handleSuccess();}"></iframe>
                    
                    <form id="registration-form" class="space-y-5" 
                          action="https://docs.google.com/forms/d/e/1FAIpQLSc1Yz0jF5wANDrrZe_DgU5yMx6cWX_2BgzI8gNUHQUTe4XQCQ/formResponse" 
                          method="POST" 
                          target="hidden_iframe"
                          onsubmit="submitted=true;">
                        <div>
                            <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2 ml-1">Business/Brand Name</label>
                            <input required type="text" name="entry.403300635" placeholder="e.g. Lagos Tech Hub" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none transition-all text-sm">
                        </div>
                        <div>
                            <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2 ml-1">WhatsApp Business Number</label>
                            <input required type="tel" name="entry.1493637334" placeholder="0801 234 5678" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none transition-all text-sm">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2 ml-1">Category</label>
                                <select required name="entry.50410248" id="category-select" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl text-sm outline-none appearance-none">
                                    <option value="">Select Industry</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-[11px] font-bold text-slate-400 uppercase tracking-wider mb-2 ml-1">Location</label>
                                <select required name="entry.1635387367" id="state-select" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl text-sm outline-none appearance-none">
                                    <option value="">Select State</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-emerald-600 text-white font-bold py-5 rounded-2xl hover:bg-emerald-700 shadow-xl shadow-emerald-100 active:scale-[0.98] transition-all flex items-center justify-center gap-2 text-sm uppercase">
                            JOIN & UNLOCK FILES
                        </button>
                    </form>
                </div>
            </div>

            <div id="success-container" class="hidden space-y-6">
                <div class="bg-white rounded-3xl shadow-xl p-8 text-center border border-emerald-50">
                    <div class="bg-emerald-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-lucide="party-popper" class="text-emerald-600 w-10 h-10"></i>
                    </div>
                    <h2 class="text-2xl font-800 text-slate-800">Registration Complete!</h2>
                    <p class="text-sm text-slate-500 mt-2 leading-relaxed">Access the VCF files and complete the share task to download.</p>
                    <div class="mt-8">
                        <button onclick="switchTab('download')" class="w-full bg-emerald-600 text-white font-bold py-4 rounded-2xl shadow-lg shadow-emerald-100 flex items-center justify-center gap-2">
                            <i data-lucide="download-cloud" class="w-5 h-5"></i> Access VCF Files
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- DOWNLOADS TAB -->
        <section id="tab-download" class="tab-content space-y-5">
            <div id="download-locked" class="py-12 text-center space-y-4">
                <div class="bg-slate-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto">
                    <i data-lucide="lock" class="text-slate-400 w-8 h-8"></i>
                </div>
                <h3 class="font-bold text-slate-800">Files Locked</h3>
                <p class="text-xs text-slate-500 px-10">Please register your business on the Home tab to access these files.</p>
                <button onclick="switchTab('home')" class="text-emerald-600 font-bold text-sm uppercase tracking-widest">Go to Home</button>
            </div>

            <div id="download-unlocked" class="hidden space-y-5">
                <div class="px-2 flex justify-between items-end">
                    <div>
                        <div class="flex items-center gap-2 text-emerald-600 mb-1">
                            <i data-lucide="check-circle-2" class="w-4 h-4"></i>
                            <span class="text-[10px] font-bold uppercase tracking-widest">Verified Member Access</span>
                        </div>
                        <h2 class="text-2xl font-800 text-slate-900 tracking-tight">Active Directories</h2>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] font-bold text-slate-400 uppercase">Last Update</p>
                        <p id="update-date" class="text-xs font-bold text-emerald-600">Jan 9, 2026</p>
                    </div>
                </div>
                
                <div id="vcf-list" class="space-y-4"></div>

                <div class="bg-blue-50 border border-blue-100 p-5 rounded-3xl flex flex-col gap-3">
                    <div class="flex gap-4">
                        <i data-lucide="info" class="text-blue-600 shrink-0"></i>
                        <p class="text-xs text-blue-800/80 leading-relaxed">
                            A new batch of vendors is added every 24-48 hours. 
                            <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="text-blue-700 font-bold underline">Join our Official WhatsApp Channel</a> 
                            for files upload updates without re-registering.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SAFETY TAB -->
        <section id="tab-safety" class="tab-content space-y-6">
            <div class="bg-slate-900 p-6 rounded-3xl text-white shadow-xl">
                <h2 class="text-xl font-bold flex items-center gap-2"><i data-lucide="shield"></i> Safety & Ethics</h2>
                <p class="text-xs opacity-90 mt-2">Protect your account and your business.</p>
            </div>
            <div class="bg-white p-6 rounded-3xl border border-slate-100 space-y-5">
                <div class="flex gap-4">
                    <div class="bg-blue-50 p-2 rounded-xl"><i data-lucide="key" class="text-blue-600 w-5 h-5"></i></div>
                    <div>
                        <h4 class="text-sm font-bold text-slate-800">Enable 2FA</h4>
                        <p class="text-xs text-slate-500 mt-1">Always keep 2-Step verification active on your WhatsApp.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-xl border-t border-slate-100 flex justify-around items-center h-20 px-10 z-50 pb-2">
        <button onclick="switchTab('home')" class="nav-item active flex flex-col items-center gap-1" data-tab="home">
            <i data-lucide="home" class="w-6 h-6"></i>
            <span class="text-[10px] font-800 uppercase">Home</span>
        </button>
        <button onclick="switchTab('download')" class="nav-item flex flex-col items-center gap-1" data-tab="download">
            <i data-lucide="layers" class="w-6 h-6"></i>
            <span class="text-[10px] font-800 uppercase">Files</span>
        </button>
        <button onclick="switchTab('safety')" class="nav-item flex flex-col items-center gap-1" data-tab="safety">
            <i data-lucide="shield-check" class="w-6 h-6"></i>
            <span class="text-[10px] font-800 uppercase">Safety</span>
        </button>
    </nav>

    <script>
        const CONFIG = {
            updateDate: "Updated Today, 11:45 PM",
            shareTarget: 4, 
            shareText: "Grow your business contacts for free on NaijaPro! Register and get the latest VCF batches here: " + window.location.href,
            vcfData: [
                { id: 1, count: 912, status: "Ongoing", file: "NaijaPro_Batch_1.vcf?v=2" },
                { id: 2, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_2.vcf?v=2" },
                { id: 3, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_3.vcf?v=2" },
                { id: 4, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_4.vcf?v=2" },
                { id: 5, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_5.vcf?v=2" },
                { id: 6, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_6.vcf?v=2" },
                { id: 7, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_7.vcf?v=2" },
                { id: 8, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_8.vcf?v=2" },
                { id: 9, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_9.vcf?v=2" },
                { id: 10, count: 0, status: "Not yet activated", file: "NaijaPro_Batch_10.vcf?v=2" }
            ]
        };

        const IS_REGISTERED_KEY = 'naijapro_user_registered_v2';
        const TASK_PROGRESS_KEY = 'naijapro_task_progress_v2';
        const DOWNLOADED_HISTORY_KEY = 'naijapro_dl_history_v2';
        
        let submitted = false;
        let shareTimeStart = 0;

        function getTaskProgress() {
            return JSON.parse(localStorage.getItem(TASK_PROGRESS_KEY) || '{}');
        }

        function getDownloadHistory() {
            return JSON.parse(localStorage.getItem(DOWNLOADED_HISTORY_KEY) || '[]');
        }

        function renderVcfFiles() {
            const container = document.getElementById('vcf-list');
            const progress = getTaskProgress();
            const history = getDownloadHistory();
            
            document.getElementById('update-date').innerText = CONFIG.updateDate;

            container.innerHTML = CONFIG.vcfData.map(vcf => {
                const count = progress[vcf.id] || 0;
                const isDownloaded = history.includes(vcf.id);
                const isUnlocked = count >= CONFIG.shareTarget;
                const percentage = (vcf.count / 1000) * 100;
                const isFirst = vcf.id === 1;
                const statusColor = isFirst ? 'text-red-600 font-extrabold' : 'text-slate-400 font-bold';
                const pipelineColorClass = vcf.count > 0 ? '' : 'pipeline-empty';
                
                let pipelineText = "Empty - Not yet started";
                if(vcf.count >= 1000) pipelineText = "Full - New batch pending";
                else if(vcf.count > 700) pipelineText = "Almost Full";
                else if(vcf.count > 0) pipelineText = "Filing in progress...";

                let actionButton = '';
                if (isDownloaded) {
                    actionButton = `
                        <div class="text-center p-4 bg-slate-50 rounded-2xl border border-dashed border-slate-200">
                            <p class="text-[11px] font-bold text-slate-500 mb-3 uppercase leading-tight">This file has been locked again for tomorrow's next VCF. Share to your status + 4 Groups/People to prepare.</p>
                            <a href="https://whatsapp.com/channel/0029VbC3ITpHVvTZ5btPTn0h" target="_blank" class="w-full bg-emerald-100 text-emerald-700 font-bold py-3 rounded-xl flex items-center justify-center gap-2 text-xs">
                                <i data-lucide="bell" class="w-3 h-3"></i> Join WhatsApp Channel
                            </a>
                        </div>
                    `;
                } else if (isUnlocked) {
                    actionButton = `
                        <button onclick="performDownload(${vcf.id}, '${vcf.file}')" 
                               class="w-full bg-slate-900 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3 active:scale-95 transition-all text-sm">
                               <i data-lucide="download" class="w-4 h-4 text-emerald-400"></i> DOWNLOAD BATCH ${vcf.id}
                        </button>
                    `;
                } else {
                    actionButton = `
                        <button onclick="initiateShare(${vcf.id})" class="w-full bg-slate-100 text-slate-500 font-bold py-4 rounded-2xl flex items-center justify-center gap-3 active:bg-slate-200 transition-all text-sm group">
                               <i data-lucide="share-2" class="w-4 h-4 text-emerald-500 group-hover:scale-110 transition-transform"></i> 
                               SHARE TO UNLOCK (${count}/${CONFIG.shareTarget})
                        </button>
                    `;
                }

                return `
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 space-y-4">
                        <div class="flex justify-between items-start">
                            <div class="flex gap-4 items-center">
                                <div class="bg-slate-50 ${isFirst ? 'text-emerald-600' : 'text-slate-400'} p-4 rounded-2xl">
                                    <i data-lucide="file-spreadsheet" class="w-6 h-6"></i>
                                </div>
                                <div>
                                    <h4 class="font-800 text-lg text-slate-800">Batch ${vcf.id} VCF</h4>
                                    <p class="text-[10px] uppercase tracking-widest ${statusColor}">${vcf.status}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-xs font-bold text-slate-800">${vcf.count}/1,000</p>
                                <p class="text-[9px] text-slate-400 uppercase">Capacity</p>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="pipeline-container">
                                <div class="pipeline-fill ${pipelineColorClass}" style="width: ${percentage}%"></div>
                            </div>
                            <div class="flex justify-between items-center">
                                <p class="text-[9px] font-bold text-slate-400 uppercase tracking-tighter">${pipelineText}</p>
                                ${vcf.count > 0 ? `<span class="text-[9px] font-bold text-red-500">${Math.round(percentage)}%</span>` : ''}
                            </div>
                        </div>
                        ${actionButton}
                    </div>
                `;
            }).join('');
            lucide.createIcons();
        }

        function initiateShare(vcfId) {
            shareTimeStart = Date.now();
            const shareUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(CONFIG.shareText)}`;
            window.open(shareUrl, '_blank');
            
            // Show verification modal after they return (simulate waiting)
            setTimeout(() => runVerification(vcfId), 1000);
        }

        async function runVerification(vcfId) {
            const timeElapsed = Date.now() - shareTimeStart;
            
            // "Sincerity Bot" Logic: 5-second check
            if (timeElapsed < 5000) {
                showAlert('Security Alert', 'System detected no sharing was initiated. Please actually share to your status or groups to proceed.', 'shield-alert');
                return;
            }

            const modal = document.getElementById('verification-modal');
            const steps = [document.getElementById('step-1'), document.getElementById('step-2'), document.getElementById('step-3')];
            const progress = document.getElementById('verification-progress');
            
            modal.style.display = 'flex';
            progress.style.width = '100%';

            for(let i=0; i<steps.length; i++) {
                await new Promise(r => setTimeout(r, 2000));
                steps[i].style.opacity = '1';
                steps[i].querySelector('i').classList.remove('hidden');
                steps[i].querySelector('.check-icon').classList.replace('bg-emerald-100', 'bg-emerald-500');
                steps[i].querySelector('i').classList.add('text-white');
                lucide.createIcons();
            }

            setTimeout(() => {
                modal.style.display = 'none';
                progress.style.width = '0%';
                steps.forEach(s => {
                    s.style.opacity = '0.25';
                    s.querySelector('i').classList.add('hidden');
                    s.querySelector('.check-icon').classList.replace('bg-emerald-500', 'bg-emerald-100');
                });

                // Update Progress
                let p = getTaskProgress();
                p[vcfId] = (p[vcfId] || 0) + 1;
                localStorage.setItem(TASK_PROGRESS_KEY, JSON.stringify(p));
                renderVcfFiles();
            }, 800);
        }

        function performDownload(vcfId, fileName) {
            const history = getDownloadHistory();
            if (!history.includes(vcfId)) {
                history.push(vcfId);
                localStorage.setItem(DOWNLOADED_HISTORY_KEY, JSON.stringify(history));
            }
            
            // Trigger actual download
            const link = document.createElement('a');
            link.href = fileName;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            renderVcfFiles();
        }

        function handleGoToFiles() {
            document.getElementById('whatsapp-promo').style.display = 'flex';
        }

        function finishPromo() {
            document.getElementById('whatsapp-promo').style.display = 'none';
            switchTab('download');
        }

        function checkUserStatus() {
            const isRegistered = localStorage.getItem(IS_REGISTERED_KEY);
            const guestView = document.getElementById('guest-view');
            const memberView = document.getElementById('member-view');
            const lockedDown = document.getElementById('download-locked');
            const unlockedDown = document.getElementById('download-unlocked');
            const statusDiv = document.getElementById('user-status');

            if (isRegistered) {
                guestView.classList.add('hidden');
                memberView.classList.remove('hidden');
                lockedDown.classList.add('hidden');
                unlockedDown.classList.remove('hidden');
                statusDiv.innerHTML = `<span class="h-2 w-2 bg-emerald-500 rounded-full animate-pulse"></span>
                                       <span class="text-[10px] font-bold text-emerald-600 uppercase tracking-tighter">Member</span>`;
                renderVcfFiles();
            } else {
                guestView.classList.remove('hidden');
                memberView.classList.add('hidden');
                lockedDown.classList.remove('hidden');
                unlockedDown.classList.add('hidden');
                statusDiv.innerHTML = `<span class="h-2 w-2 bg-slate-300 rounded-full"></span>
                                       <span class="text-[10px] font-bold text-slate-400 uppercase tracking-tighter">Guest</span>`;
            }
            lucide.createIcons();
        }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(`tab-${id}`).classList.add('active');
            const navBtn = document.querySelector(`[data-tab="${id}"]`);
            if(navBtn) navBtn.classList.add('active');
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function handleSuccess() {
            localStorage.setItem(IS_REGISTERED_KEY, 'true');
            document.getElementById('form-container').classList.add('hidden');
            document.getElementById('success-container').classList.remove('hidden');
            checkUserStatus();
        }

        function showAlert(title, message, iconName = 'info') {
            document.getElementById('alert-title').innerText = title;
            document.getElementById('alert-message').innerText = message;
            document.getElementById('alert-icon').innerHTML = `<i data-lucide="${iconName}" class="w-12 h-12 text-emerald-600 mx-auto"></i>`;
            document.getElementById('custom-alert').style.display = 'flex';
            lucide.createIcons();
        }

        function closeAlert() {
            document.getElementById('custom-alert').style.display = 'none';
        }

        // Init
        const categories = ["Fashion & Lifestyle", "Gadgets & Electronics", "Real Estate", "Beauty & Skincare", "Logistics & Delivery", "Digital Assets/Crypto", "Automobiles", "Food & Groceries", "Interior Decor", "Education", "Consultancy", "Others"];
        const states = ["Lagos", "Abuja", "Rivers", "Oyo", "Kano", "Ogun", "Enugu", "Delta", "Anambra", "Edo", "Abia", "Adamawa", "Akwa Ibom", "Bauchi", "Bayelsa", "Benue", "Borno", "Cross River", "Ebonyi", "Ekiti", "Gombe", "Imo", "Jigawa", "Kaduna", "Katsina", "Kebbi", "Kogi", "Kwara", "Nasarawa", "Niger", "Ondo", "Osun", "Plateau", "Sokoto", "Taraba", "Yobe", "Zamfara"];
        
        const catSelect = document.getElementById('category-select');
        categories.forEach(c => catSelect.add(new Option(c, c)));
        const stSelect = document.getElementById('state-select');
        states.forEach(s => stSelect.add(new Option(s, s)));

        lucide.createIcons();
        checkUserStatus();
    </script>
</body>
</html>

